---
- name: Install Java, Logstash, and Nginx (with Dependencies)
  hosts: logstash_server
  become: yes

  tasks:
    - name: Install Java for Logstash
      yum:
        name: java-11-openjdk
        state: present

    - name: Register Java in alternatives
      command: alternatives --install /usr/bin/java java /usr/lib/jvm/java-11-openjdk/bin/java 1
      args:
        creates: /etc/alternatives/java

    - name: Set Java as default
      command: alternatives --set java /usr/lib/jvm/java-11-openjdk/bin/java
      ignore_errors: yes  # 등록되지 않은 경우를 대비해 에러 무시

    - name: Verify Java Installation
      command: java -version
      register: java_version_output
      changed
